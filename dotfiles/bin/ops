#!/usr/bin/python3
import fire
import subprocess


def sh(command, capture=False):
    kwargs = {}
    if capture:
        kwargs.update(stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    process = subprocess.Popen(command, shell=True, **kwargs)
    (stdout, stderr) = process.communicate()
    if process.returncode:
        raise RuntimeError(stderr)
    return (stdout or b'').decode('utf-8').strip()


def commit():
    staged = sh('git diff --staged --name-only', capture=True)
    staged = ', '.join(staged.splitlines())
    sh(f'git commit -m "Updated {staged}"')


if __name__ == '__main__':
    fire.Fire()
